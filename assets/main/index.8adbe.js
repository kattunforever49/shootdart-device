window.__require=function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){return o(e[s][1][t]||t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){var r,o;r=this,o=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}function f(t){var e=c();return function(){var n,r=s(t);if(e){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h(this,n)}}function p(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=p(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function d(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=d(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}var m=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,g=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],k=function(t){var e,n,r,o,i=t,s=t.indexOf("["),a=t.indexOf("]");-1!=s&&-1!=a&&(t=t.substring(0,s)+t.substring(s,a).replace(/:/g,";")+t.substring(a,t.length));for(var c=m.exec(t||""),u={},h=14;h--;)u[g[h]]=c[h]||"";return-1!=s&&-1!=a&&(u.source=i,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=(o=(r=u.path).replace(/\/{2,9}/g,"/").split("/"),"/"!=r.substr(0,1)&&0!==r.length||o.splice(0,1),"/"==r.substr(r.length-1,1)&&o.splice(o.length-1,1),o),u.queryKey=(e=u.query,n={},e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,r){e&&(n[e]=r)}),n),u};function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),r=k(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}var w={exports:{}};try{w.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(zt){w.exports=!1}var _=w.exports,E="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("","return this")();function O(t){var e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||_))return new XMLHttpRequest}catch(n){}if(!e)try{return new(E[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function A(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce(function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e},{})}var R=setTimeout,T=clearTimeout;function C(t,e){e.useNativeTimers?(t.setTimeoutFn=R.bind(E),t.clearTimeoutFn=T.bind(E)):(t.setTimeoutFn=setTimeout.bind(E),t.clearTimeoutFn=clearTimeout.bind(E))}var S=N;function N(t){if(t)return x(t)}function x(t){for(var e in N.prototype)t[e]=N.prototype[e];return t}N.prototype.on=N.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},N.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},N.prototype.off=N.prototype.removeListener=N.prototype.removeAllListeners=N.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<r.length;o++)if((n=r[o])===e||n.fn===e){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},N.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,e)}return this},N.prototype.emitReserved=N.prototype.emit,N.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},N.prototype.hasListeners=function(t){return!!this.listeners(t).length};var B=Object.create(null);B.open="0",B.close="1",B.ping="2",B.pong="3",B.message="4",B.upgrade="5",B.noop="6";var P=Object.create(null);Object.keys(B).forEach(function(t){P[B[t]]=t});for(var j={type:"error",data:"parser error"},L="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),D="function"==typeof ArrayBuffer,q=function(t,e,n){var r,o=t.type,i=t.data;return L&&i instanceof Blob?e?n(i):I(i,n):D&&(i instanceof ArrayBuffer||(r=i,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?e?n(i):I(new Blob([i]),n):n(B[o]+(i||""))},I=function(t,e){var n=new FileReader;return n.onload=function(){var t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)},F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M="undefined"==typeof Uint8Array?[]:new Uint8Array(256),U=0;U<F.length;U++)M[F.charCodeAt(U)]=U;var V,H=function(t){var e,n,r,o,i,s=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),h=new Uint8Array(u);for(e=0;e<a;e+=4)n=M[t.charCodeAt(e)],r=M[t.charCodeAt(e+1)],o=M[t.charCodeAt(e+2)],i=M[t.charCodeAt(e+3)],h[c++]=n<<2|r>>4,h[c++]=(15&r)<<4|o>>2,h[c++]=(3&o)<<6|63&i;return u},z="function"==typeof ArrayBuffer,K=function(t,e){if("string"!=typeof t)return{type:"message",data:J(t,e)};var n=t.charAt(0);return"b"===n?{type:"message",data:Y(t.substring(1),e)}:P[n]?t.length>1?{type:P[n],data:t.substring(1)}:{type:P[n]}:j},Y=function(t,e){if(z){var n=H(t);return J(n,e)}return{base64:!0,data:t}},J=function(t,e){switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}},W=String.fromCharCode(30),$=function(t,e){var n=t.length,r=new Array(n),o=0;t.forEach(function(t,i){q(t,!1,function(t){r[i]=t,++o===n&&e(r.join(W))})})},X=function(t,e){for(var n=t.split(W),r=[],o=0;o<n.length;o++){var i=K(n[o],e);if(r.push(i),"error"===i.type)break}return r},G=function(){i(n,S);var t=f(n);function n(r){var o;return e(this,n),(o=t.call(this)).writable=!1,C(u(o),r),o.opts=r,o.query=r.query,o.readyState="",o.socket=r.socket,o}return r(n,[{key:"onError",value:function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,l(s(n.prototype),"emit",this).call(this,"error",r),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(t){"open"===this.readyState&&this.write(t)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,l(s(n.prototype),"emit",this).call(this,"open")}},{key:"onData",value:function(t){var e=K(t,this.socket.binaryType);this.onPacket(e)}},{key:"onPacket",value:function(t){l(s(n.prototype),"emit",this).call(this,"packet",t)}},{key:"onClose",value:function(){this.readyState="closed",l(s(n.prototype),"emit",this).call(this,"close")}}]),n}(),Q="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Z=64,tt={},et=0,nt=0;function rt(t){var e="";do{e=Q[t%Z]+e,t=Math.floor(t/Z)}while(t>0);return e}function ot(){var t=rt(+new Date);return t!==V?(et=0,V=t):t+"."+rt(et++)}for(;nt<Z;nt++)tt[Q[nt]]=nt;ot.encode=rt,ot.decode=function(t){var e=0;for(nt=0;nt<t.length;nt++)e=e*Z+tt[t.charAt(nt)];return e};var it=ot,st={encode:function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},decode:function(t){for(var e={},n=t.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},at=function(){i(n,G);var t=f(n);function n(){var r;return e(this,n),(r=t.apply(this,arguments)).polling=!1,r}return r(n,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(t){var e=this;this.readyState="pausing";var n=function(){e.readyState="paused",t()};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(t){var e=this;X(t,this.socket.binaryType).forEach(function(t){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var t=this,e=function(){t.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}},{key:"write",value:function(t){var e=this;this.writable=!1,$(t,function(t){e.doWrite(t,function(){e.writable=!0,e.emit("drain")})})}},{key:"uri",value:function(){var t=this.query||{},e=this.opts.secure?"https":"http",n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=it()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);var r=st.encode(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}}]),n}();function ct(){}var ut=null!=new O({xdomain:!1}).responseType,ht=function(){i(n,at);var t=f(n);function n(r){var o;if(e(this,n),o=t.call(this,r),"undefined"!=typeof location){var i="https:"===location.protocol,s=location.port;s||(s=i?"443":"80"),o.xd="undefined"!=typeof location&&r.hostname!==location.hostname||s!==r.port,o.xs=r.secure!==i}var a=r&&r.forceBase64;return o.supportsBinary=ut&&!a,o}return r(n,[{key:"request",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(t,{xd:this.xd,xs:this.xs},this.opts),new ft(this.uri(),t)}},{key:"doWrite",value:function(t,e){var n=this,r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",function(t){n.onError("xhr post error",t)})}},{key:"doPoll",value:function(){var t=this,e=this.request();e.on("data",this.onData.bind(this)),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e}}]),n}(),ft=function(){i(n,S);var t=f(n);function n(r,o){var i;return e(this,n),C(u(i=t.call(this)),o),i.opts=o,i.method=o.method||"GET",i.uri=r,i.async=!1!==o.async,i.data=void 0!==o.data?o.data:null,i.create(),i}return r(n,[{key:"create",value:function(){var t=this,e=A(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;var r=this.xhr=new O(e);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var o in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this.opts.extraHeaders[o])}catch(i){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{r.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?t.onLoad():t.setTimeoutFn(function(){t.onError("number"==typeof r.status?r.status:0)},0))},r.send(this.data)}catch(i){return void this.setTimeoutFn(function(){t.onError(i)},0)}"undefined"!=typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(t){this.emit("data",t),this.onSuccess()}},{key:"onError",value:function(t){this.emit("error",t),this.cleanup(!0)}},{key:"cleanup",value:function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=ct,t)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete n.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var t=this.xhr.responseText;null!==t&&this.onData(t)}},{key:"abort",value:function(){this.cleanup()}}]),n}();function pt(){for(var t in ft.requests)ft.requests.hasOwnProperty(t)&&ft.requests[t].abort()}ft.requestsCount=0,ft.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",pt):"function"==typeof addEventListener&&addEventListener("onpagehide"in E?"pagehide":"unload",pt,!1));var lt="function"==typeof Promise&&"function"==typeof Promise.resolve?function(t){return Promise.resolve().then(t)}:function(t,e){return e(t,0)},dt=E.WebSocket||E.MozWebSocket,yt="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),vt={websocket:function(){i(n,G);var t=f(n);function n(r){var o;return e(this,n),(o=t.call(this,r)).supportsBinary=!r.forceBase64,o}return r(n,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var t=this.uri(),e=this.opts.protocols,n=yt?{}:A(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=yt?new dt(t,e,n):e?new dt(t,e):new dt(t)}catch(zt){return this.emit("error",zt)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var t=this;this.ws.onopen=function(){t.opts.autoUnref&&t.ws._socket.unref(),t.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=function(e){return t.onData(e.data)},this.ws.onerror=function(e){return t.onError("websocket error",e)}}},{key:"write",value:function(t){var e=this;this.writable=!1;for(var n=function(n){var r=t[n],o=n===t.length-1;q(r,e.supportsBinary,function(t){try{e.ws.send(t)}catch(n){}o&&lt(function(){e.writable=!0,e.emit("drain")},e.setTimeoutFn)})},r=0;r<t.length;r++)n(r)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var t=this.query||{},e=this.opts.secure?"wss":"ws",n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=it()),this.supportsBinary||(t.b64=1);var r=st.encode(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"check",value:function(){return!(!dt||"__initialize"in dt&&this.name===n.prototype.name)}}]),n}(),polling:ht},mt=function(){i(s,S);var n=f(s);function s(r){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(this,s),i=n.call(this),r&&"object"===t(r)&&(a=r,r=null),r?(r=k(r),a.hostname=r.host,a.secure="https"===r.protocol||"wss"===r.protocol,a.port=r.port,r.query&&(a.query=r.query)):a.host&&(a.hostname=k(a.host).host),C(u(i),a),i.secure=null!=a.secure?a.secure:"undefined"!=typeof location&&"https:"===location.protocol,a.hostname&&!a.port&&(a.port=i.secure?"443":"80"),i.hostname=a.hostname||("undefined"!=typeof location?location.hostname:"localhost"),i.port=a.port||("undefined"!=typeof location&&location.port?location.port:i.secure?"443":"80"),i.transports=a.transports||["polling","websocket"],i.readyState="",i.writeBuffer=[],i.prevBufferLen=0,i.opts=o({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},a),i.opts.path=i.opts.path.replace(/\/$/,"")+"/","string"==typeof i.opts.query&&(i.opts.query=st.decode(i.opts.query)),i.id=null,i.upgrades=null,i.pingInterval=null,i.pingTimeout=null,i.pingTimeoutTimer=null,"function"==typeof addEventListener&&(i.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){i.transport&&(i.transport.removeAllListeners(),i.transport.close())},!1),"localhost"!==i.hostname&&(i.offlineEventListener=function(){i.onClose("transport close")},addEventListener("offline",i.offlineEventListener,!1))),i.open(),i}return r(s,[{key:"createTransport",value:function(t){var e=gt(this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);var n=o({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new vt[t](n)}},{key:"open",value:function(){var t,e=this;if(this.opts.rememberUpgrade&&s.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){e.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(n){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}},{key:"setTransport",value:function(t){var e=this;this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",function(){e.onClose("transport close")})}},{key:"probe",value:function(t){var e=this,n=this.createTransport(t),r=!1;s.priorWebsocketSuccess=!1;var o=function(){r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",function(t){if(!r)if("pong"===t.type&&"probe"===t.data){if(e.upgrading=!0,e.emitReserved("upgrading",n),!n)return;s.priorWebsocketSuccess="websocket"===n.name,e.transport.pause(function(){r||"closed"!==e.readyState&&(f(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emitReserved("upgrade",n),n=null,e.upgrading=!1,e.flush())})}else{var o=new Error("probe error");o.transport=n.name,e.emitReserved("upgradeError",o)}}))};function i(){r||(r=!0,f(),n.close(),n=null)}var a=function(t){var r=new Error("probe error: "+t);r.transport=n.name,i(),e.emitReserved("upgradeError",r)};function c(){a("transport closed")}function u(){a("socket closed")}function h(t){n&&t.name!==n.name&&i()}var f=function(){n.removeListener("open",o),n.removeListener("error",a),n.removeListener("close",c),e.off("close",u),e.off("upgrading",h)};n.once("open",o),n.once("error",a),n.once("close",c),this.once("close",u),this.once("upgrading",h),n.open()}},{key:"onOpen",value:function(){if(this.readyState="open",s.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},{key:"onPacket",value:function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}},{key:"onHandshake",value:function(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var t=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(function(){t.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}},{key:"write",value:function(t,e,n){return this.sendPacket("message",t,e,n),this}},{key:"send",value:function(t,e,n){return this.sendPacket("message",t,e,n),this}},{key:"sendPacket",value:function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:t,data:e,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var t=this,e=function(){t.onClose("forced close"),t.transport.close()},n=function n(){t.off("upgrade",n),t.off("upgradeError",n),e()},r=function(){t.once("upgrade",n),t.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){t.upgrading?r():e()}):this.upgrading?r():e()),this}},{key:"onError",value:function(t){s.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}},{key:"onClose",value:function(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}]),s}();function gt(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}mt.protocol=4;var kt,bt="function"==typeof ArrayBuffer,wt=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer},_t=Object.prototype.toString,Et="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===_t.call(Blob),Ot="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===_t.call(File);function At(t){return bt&&(t instanceof ArrayBuffer||wt(t))||Et&&t instanceof Blob||Ot&&t instanceof File}function Rt(e){if(!e||"object"!==t(e))return!1;if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(Rt(e[n]))return!0;return!1}if(At(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Rt(e.toJSON(),!0);for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&Rt(e[o]))return!0;return!1}function Tt(t){var e=[],n=t.data,r=t;return r.data=Ct(n,e),r.attachments=e.length,{packet:r,buffers:e}}function Ct(e,n){if(!e)return e;if(At(e)){var r={_placeholder:!0,num:n.length};return n.push(e),r}if(Array.isArray(e)){for(var o=new Array(e.length),i=0;i<e.length;i++)o[i]=Ct(e[i],n);return o}if("object"===t(e)&&!(e instanceof Date)){var s={};for(var a in e)e.hasOwnProperty(a)&&(s[a]=Ct(e[a],n));return s}return e}function St(t,e){return t.data=Nt(t.data,e),t.attachments=void 0,t}function Nt(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(Array.isArray(e))for(var r=0;r<e.length;r++)e[r]=Nt(e[r],n);else if("object"===t(e))for(var o in e)e.hasOwnProperty(o)&&(e[o]=Nt(e[o],n));return e}(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(kt||(kt={}));var xt=function(){function t(){e(this,t)}return r(t,[{key:"encode",value:function(t){return t.type!==kt.EVENT&&t.type!==kt.ACK||!Rt(t)?[this.encodeAsString(t)]:(t.type=t.type===kt.EVENT?kt.BINARY_EVENT:kt.BINARY_ACK,this.encodeAsBinary(t))}},{key:"encodeAsString",value:function(t){var e=""+t.type;return t.type!==kt.BINARY_EVENT&&t.type!==kt.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e}},{key:"encodeAsBinary",value:function(t){var e=Tt(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r}}]),t}(),Bt=function(){i(o,S);var n=f(o);function o(){return e(this,o),n.call(this)}return r(o,[{key:"add",value:function(t){var e;if("string"==typeof t)(e=this.decodeString(t)).type===kt.BINARY_EVENT||e.type===kt.BINARY_ACK?(this.reconstructor=new jt(e),0===e.attachments&&l(s(o.prototype),"emitReserved",this).call(this,"decoded",e)):l(s(o.prototype),"emitReserved",this).call(this,"decoded",e);else{if(!At(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,l(s(o.prototype),"emitReserved",this).call(this,"decoded",e))}}},{key:"decodeString",value:function(t){var e=0,n={type:Number(t.charAt(0))};if(void 0===kt[n.type])throw new Error("unknown packet type "+n.type);if(n.type===kt.BINARY_EVENT||n.type===kt.BINARY_ACK){for(var r=e+1;"-"!==t.charAt(++e)&&e!=t.length;);var i=t.substring(r,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===t.charAt(e+1)){for(var s=e+1;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(s,e)}else n.nsp="/";var a=t.charAt(e+1);if(""!==a&&Number(a)==a){for(var c=e+1;++e;){var u=t.charAt(e);if(null==u||Number(u)!=u){--e;break}if(e===t.length)break}n.id=Number(t.substring(c,e+1))}if(t.charAt(++e)){var h=Pt(t.substr(e));if(!o.isPayloadValid(n.type,h))throw new Error("invalid payload");n.data=h}return n}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(e,n){switch(e){case kt.CONNECT:return"object"===t(n);case kt.DISCONNECT:return void 0===n;case kt.CONNECT_ERROR:return"string"==typeof n||"object"===t(n);case kt.EVENT:case kt.BINARY_EVENT:return Array.isArray(n)&&n.length>0;case kt.ACK:case kt.BINARY_ACK:return Array.isArray(n)}}}]),o}();function Pt(t){try{return JSON.parse(t)}catch(e){return!1}}var jt=function(){function t(n){e(this,t),this.packet=n,this.buffers=[],this.reconPack=n}return r(t,[{key:"takeBinaryData",value:function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=St(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),t}(),Lt=Object.freeze({__proto__:null,protocol:5,get PacketType(){return kt},Encoder:xt,Decoder:Bt});function Dt(t,e,n){return t.on(e,n),function(){t.off(e,n)}}var qt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),It=function(){i(n,S);var t=f(n);function n(r,o,i){var s;return e(this,n),(s=t.call(this)).connected=!1,s.disconnected=!0,s.receiveBuffer=[],s.sendBuffer=[],s.ids=0,s.acks={},s.flags={},s.io=r,s.nsp=o,i&&i.auth&&(s.auth=i.auth),s.io._autoConnect&&s.open(),s}return r(n,[{key:"subEvents",value:function(){if(!this.subs){var t=this.io;this.subs=[Dt(t,"open",this.onopen.bind(this)),Dt(t,"packet",this.onpacket.bind(this)),Dt(t,"error",this.onerror.bind(this)),Dt(t,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen(),this)}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.unshift("message"),this.emit.apply(this,e),this}},{key:"emit",value:function(t){if(qt.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.unshift(t);var o={type:kt.EVENT,data:n,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]){var i=this.ids++,s=n.pop();this._registerAckCallback(i,s),o.id=i}var a=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,c=this.flags.volatile&&(!a||!this.connected);return c||(this.connected?this.packet(o):this.sendBuffer.push(o)),this.flags={},this}},{key:"_registerAckCallback",value:function(t,e){var n=this,r=this.flags.timeout;if(void 0!==r){var o=this.io.setTimeoutFn(function(){delete n.acks[t];for(var r=0;r<n.sendBuffer.length;r++)n.sendBuffer[r].id===t&&n.sendBuffer.splice(r,1);e.call(n,new Error("operation has timed out"))},r);this.acks[t]=function(){n.io.clearTimeoutFn(o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.apply(n,[null].concat(r))}}else this.acks[t]=e}},{key:"packet",value:function(t){t.nsp=this.nsp,this.io._packet(t)}},{key:"onopen",value:function(){var t=this;"function"==typeof this.auth?this.auth(function(e){t.packet({type:kt.CONNECT,data:e})}):this.packet({type:kt.CONNECT,data:this.auth})}},{key:"onerror",value:function(t){this.connected||this.emitReserved("connect_error",t)}},{key:"onclose",value:function(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}},{key:"onpacket",value:function(t){if(t.nsp===this.nsp)switch(t.type){case kt.CONNECT:if(t.data&&t.data.sid){var e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case kt.EVENT:case kt.BINARY_EVENT:this.onevent(t);break;case kt.ACK:case kt.BINARY_ACK:this.onack(t);break;case kt.DISCONNECT:this.ondisconnect();break;case kt.CONNECT_ERROR:this.destroy();var n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n)}}},{key:"onevent",value:function(t){var e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}},{key:"emitEvent",value:function(t){if(this._anyListeners&&this._anyListeners.length){var e,r=v(this._anyListeners.slice());try{for(r.s();!(e=r.n()).done;)e.value.apply(this,t)}catch(zt){r.e(zt)}finally{r.f()}}l(s(n.prototype),"emit",this).apply(this,t)}},{key:"ack",value:function(t){var e=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];e.packet({type:kt.ACK,id:t,data:o})}}}},{key:"onack",value:function(t){var e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}},{key:"onconnect",value:function(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}},{key:"emitBuffered",value:function(){var t=this;this.receiveBuffer.forEach(function(e){return t.emitEvent(e)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(e){return t.packet(e)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach(function(t){return t()}),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:kt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(t){return this.flags.compress=t,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(t){return this.flags.timeout=t,this}},{key:"onAny",value:function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}},{key:"prependAny",value:function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}},{key:"offAny",value:function(t){if(!this._anyListeners)return this;if(t){for(var e=this._anyListeners,n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}}]),n}(),Ft=Mt;function Mt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Mt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},Mt.prototype.reset=function(){this.attempts=0},Mt.prototype.setMin=function(t){this.ms=t},Mt.prototype.setMax=function(t){this.max=t},Mt.prototype.setJitter=function(t){this.jitter=t};var Ut=function(){i(o,S);var n=f(o);function o(r,i){var s,a;e(this,o),(s=n.call(this)).nsps={},s.subs=[],r&&"object"===t(r)&&(i=r,r=void 0),(i=i||{}).path=i.path||"/socket.io",s.opts=i,C(u(s),i),s.reconnection(!1!==i.reconnection),s.reconnectionAttempts(i.reconnectionAttempts||1/0),s.reconnectionDelay(i.reconnectionDelay||1e3),s.reconnectionDelayMax(i.reconnectionDelayMax||5e3),s.randomizationFactor(null!==(a=i.randomizationFactor)&&void 0!==a?a:.5),s.backoff=new Ft({min:s.reconnectionDelay(),max:s.reconnectionDelayMax(),jitter:s.randomizationFactor()}),s.timeout(null==i.timeout?2e4:i.timeout),s._readyState="closed",s.uri=r;var c=i.parser||Lt;return s.encoder=new c.Encoder,s.decoder=new c.Decoder,s._autoConnect=!1!==i.autoConnect,s._autoConnect&&s.open(),s}return r(o,[{key:"reconnection",value:function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}},{key:"reconnectionAttempts",value:function(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}},{key:"reconnectionDelay",value:function(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}},{key:"randomizationFactor",value:function(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}},{key:"reconnectionDelayMax",value:function(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}},{key:"timeout",value:function(t){return arguments.length?(this._timeout=t,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(t){var e=this;if(~this._readyState.indexOf("open"))return this;this.engine=new mt(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var o=Dt(n,"open",function(){r.onopen(),t&&t()}),i=Dt(n,"error",function(n){r.cleanup(),r._readyState="closed",e.emitReserved("error",n),t?t(n):r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;0===s&&o();var a=this.setTimeoutFn(function(){o(),n.close(),n.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(o),this.subs.push(i),this}},{key:"connect",value:function(t){return this.open(t)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var t=this.engine;this.subs.push(Dt(t,"ping",this.onping.bind(this)),Dt(t,"data",this.ondata.bind(this)),Dt(t,"error",this.onerror.bind(this)),Dt(t,"close",this.onclose.bind(this)),Dt(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(t){this.decoder.add(t)}},{key:"ondecoded",value:function(t){this.emitReserved("packet",t)}},{key:"onerror",value:function(t){this.emitReserved("error",t)}},{key:"socket",value:function(t,e){var n=this.nsps[t];return n||(n=new It(this,t,e),this.nsps[t]=n),n}},{key:"_destroy",value:function(){for(var t=0,e=Object.keys(this.nsps);t<e.length;t++){var n=e[t];if(this.nsps[n].active)return}this._close()}},{key:"_packet",value:function(t){for(var e=this.encoder.encode(t),n=0;n<e.length;n++)this.engine.write(e[n],t.options)}},{key:"cleanup",value:function(){this.subs.forEach(function(t){return t()}),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var t=this;if(this._reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn(function(){e.skipReconnect||(t.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(function(n){n?(e._reconnecting=!1,e.reconnect(),t.emitReserved("reconnect_error",n)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}},{key:"onreconnect",value:function(){var t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}]),o}(),Vt={};function Ht(e,n){"object"===t(e)&&(n=e,e=void 0);var r,o=b(e,(n=n||{}).path||"/socket.io"),i=o.source,s=o.id,a=o.path,c=Vt[s]&&a in Vt[s].nsps;return n.forceNew||n["force new connection"]||!1===n.multiplex||c?r=new Ut(i,n):(Vt[s]||(Vt[s]=new Ut(i,n)),r=Vt[s]),o.query&&!n.query&&(n.query=o.queryKey),r.socket(o.path,n)}return o(Ht,{Manager:Ut,Socket:It,io:Ht,connect:Ht}),Ht},"object"==typeof n&&void 0!==e?e.exports=o():"function"==typeof define&&define.amd?define(o):(r="undefined"!=typeof globalThis?globalThis:r||self).io=o()},{}],Drag:[function(t,e,n){"use strict";cc._RF.push(e,"6e71aPU62dMGKLhEVq8pn5W","Drag");var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var s=t("socket.io-client/dist/socket.io.js"),a=cc._decorator,c=a.ccclass,u=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.drawer=null,e.powerDisplayer=null,e.intervalID=null,e.dragState=0,e.progressIncreaseSign=1,e}return o(e,t),e.prototype.start=function(){this.network(),this.drag()},e.prototype.drag=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){t.startTime=(new Date).getTime(),t.endPos=t.node.convertToNodeSpaceAR(e.getLocation()),t.startPos=cc.v2(0,0),t.dragState=1}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.aim(e)}),this.node.on(cc.Node.EventType.TOUCH_END,function(t){console.log("OnTouchEnd:"+t)}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){t.aim(e),t.socket.emit("cmd",JSON.stringify({cmdName:"shoot",data:{}}))})},e.prototype.aim=function(t){this.endPos=this.node.convertToNodeSpaceAR(t.getLocation());var e=cc.winSize.width/2-10,n=this.endPos.len();n>e&&(n=e),this.endPos=this.endPos.normalize().mul(n);var r=n/e;if(null!=this.socket&&this.socket.connected){var o=this.endPos.sub(this.startPos);o.normalizeSelf();var i=o.dot(cc.v2(0,1));this.endPos.x<this.startPos.x&&(i*=-1),console.log("dot:"+i);var s={cmdName:"aim",data:{dot:i,ratio:r,force:this.powerDisplayer.progress}};this.socket.emit("cmd",JSON.stringify(s)),console.log("\u5411server\u767c\u9001:"+JSON.stringify(s))}},e.prototype.network=function(){var t=this;this.socket=s.io("https://shootdart-server.herokuapp.com/",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"},transports:["websocket","polling","flashsocket"]}),this.socket.on("connect",function(){console.log("\u8207server\u9023\u7dda "+t.socket.id),t.deviceInit(),t.socket.on("gamestart",function(t){console.log("game start "+t.data)}),t.socket.on("cmd",function(t){console.log("cmd: "+t.cmdName)})})},e.prototype.deviceInit=function(){this.socket.emit("deviceInit")},e.prototype.update=function(t){if(this.powerDisplayer.progress+=this.progressIncreaseSign*t,this.powerDisplayer.progress=cc.misc.clamp01(this.powerDisplayer.progress),(this.powerDisplayer.progress>=1||this.powerDisplayer.progress<=0)&&(this.progressIncreaseSign*=-1),1==this.dragState){var e=this.drawer;e.clear(),e.strokeColor=cc.Color.RED,e.fillColor=cc.Color.RED,e.circle(this.endPos.x,this.endPos.y,10),e.fill(),e.lineWidth=6,e.moveTo(this.startPos.x,this.startPos.y),e.lineTo(this.endPos.x,this.endPos.y),cc.winSize,e.stroke()}},i([u(cc.Graphics)],e.prototype,"drawer",void 0),i([u(cc.ProgressBar)],e.prototype,"powerDisplayer",void 0),i([c],e)}(cc.Component);n.default=h,cc._RF.pop()},{"socket.io-client/dist/socket.io.js":1}],SocketTest:[function(t,e,n){"use strict";cc._RF.push(e,"2365d5Y/y1IO4bwb432VfzC","SocketTest");var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,c=s.property,u=t("socket.io-client/dist/socket.io.js"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return o(e,t),e.prototype.start=function(){var t=u.io("http://localhost:8700",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"},transports:["websocket","polling","flashsocket"]});t.on("connect",function(){console.log("Socket.ID: "+t.id),t.emit("message",{data:"hello"})})},i([c(cc.Label)],e.prototype,"label",void 0),i([c],e.prototype,"text",void 0),i([a],e)}(cc.Component);n.default=h,cc._RF.pop()},{"socket.io-client/dist/socket.io.js":1}],"script-name.d":[function(t,e){"use strict";cc._RF.push(e,"efdc5KPyfhOk6H+EFuVGOh8","script-name.d"),cc._RF.pop()},{}]},{},["Drag","SocketTest","script-name.d"]);